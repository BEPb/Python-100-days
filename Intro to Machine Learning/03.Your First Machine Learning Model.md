Your First Machine Learning Model

Выбор данных для моделирования
В вашем наборе данных было слишком много переменных, чтобы обернуть голову или даже распечатать. Как можно 
сократить этот огромный объем данных до того, что вы понимаете?

Мы начнем с выбора нескольких переменных, используя нашу интуицию. Более поздние курсы покажут вам статистические 
методы автоматического определения приоритетов переменных.

Чтобы выбрать переменные / столбцы, нам нужно увидеть список всех столбцов в наборе данных. Это делается с помощью 
свойства columns DataFrame (нижняя строка кода ниже).

```python
import pandas as pd

melbourne_file_path = '../input/melbourne-housing-snapshot/melb_data.csv'
melbourne_data = pd.read_csv(melbourne_file_path) 
melbourne_data.columns

# В данных Мельбурна есть некоторые пропущенные значения (некоторые дома, для которых не были записаны некоторые переменные).
# Мы научимся обрабатывать отсутствующие значения в следующем руководстве.
# В ваших данных по Айове нет пропущенных значений в используемых вами столбцах.
# Итак, мы сейчас возьмем самый простой вариант и отбросим дома из наших данных.
# Пока об этом особо не беспокойтесь, хотя код такой:

# dropna удаляет отсутствующие значения (воспринимайте na как "недоступно")
melbourne_data = melbourne_data.dropna(axis=0)
```

Есть много способов выбрать подмножество ваших данных. В курсе Pandas они рассматриваются более подробно, но пока 
мы сосредоточимся на двух подходах.

### Точечная нотация, которую мы используем для выбора «цели прогноза».
Выбор с помощью списка столбцов, который мы используем для выбора «функций»
Выбор цели прогноза
Вы можете извлечь переменную с точечной нотацией. Этот единственный столбец хранится в серии, которая в целом 
похожа на DataFrame только с одним столбцом данных.

Мы будем использовать точечную нотацию, чтобы выбрать столбец, который мы хотим предсказать, который называется 
целью прогнозирования. По соглашению цель прогноза называется 'y'. Итак, код, который нам нужен для сохранения цен на 
жилье в данных Мельбурна, выглядит так:

```python
y = melbourne_data.Price
```

#### Выбор «Особенности»
Столбцы, которые вводятся в нашу модель (а затем используются для прогнозов), называются «функциями». В нашем 
случае это будут столбцы, используемые для определения цены дома. Иногда вы будете использовать все столбцы, кроме 
целевого, в качестве функций. В других случаях вам будет лучше с меньшим количеством функций.

На данный момент мы построим модель только с несколькими функциями. Позже вы увидите, как повторять и сравнивать 
модели, построенные с различными функциями.

Мы выбираем несколько функций, предоставляя список имен столбцов в скобках. Каждый элемент в этом списке должен 
быть строкой (в кавычках).

Вот пример:
```python
melbourne_features = ['Rooms', 'Bathroom', 'Landsize', 'Lattitude', 'Longtitude']
```

По соглашению эти данные называются X.

```python
X = melbourne_data[melbourne_features]
```

Давайте быстро рассмотрим данные, которые мы будем использовать для прогнозирования цен на жилье, используя метод 
описания и метод заголовка, который показывает несколько верхних строк.

```python
X.describe()

X.head()
```
Визуальная проверка данных с помощью этих команд - важная часть работы специалиста по данным. В наборе данных часто 
встречаются сюрпризы, заслуживающие дальнейшего изучения.

### Построение вашей модели
Вы будете использовать библиотеку scikit-learn для создания своих моделей. При кодировании эта библиотека пишется 
как sklearn, как вы увидите в примере кода. Scikit-learn - это, пожалуй, самая популярная библиотека для 
моделирования типов данных, которые обычно хранятся в DataFrames.

Шаги по созданию и использованию модели:

Определите: какой это будет тип модели? Дерево решений? Какой-то другой тип модели? Также указаны некоторые другие 
параметры типа модели.
- Fit: захват шаблонов из предоставленных данных. Это сердце моделирования.
- Predict: именно так это звучит
- Evaluate: определить, насколько точны прогнозы модели.

Вот пример определения модели дерева решений с помощью scikit-learn и согласования ее с функциями и целевой переменной.

```python
from sklearn.tree import DecisionTreeRegressor

# Определите модель. Укажите число для random_state, чтобы гарантировать одинаковые результаты при каждом запуске
melbourne_model = DecisionTreeRegressor(random_state=1)

# Fit model
melbourne_model.fit(X, y)
```
Многие модели машинного обучения допускают некоторую случайность в обучении моделей. Указание числа для random_state 
гарантирует, что вы получите одинаковые результаты при каждом запуске. Это считается хорошей практикой. Вы 
используете любое число, и качество модели не будет существенно зависеть от того, какое именно значение вы выберете.

Теперь у нас есть подобранная модель, которую мы можем использовать для прогнозов.

На практике вы захотите спрогнозировать появление на рынке новых домов, а не домов, на которые у нас уже есть цены. 
Но мы сделаем прогнозы для первых нескольких строк обучающих данных, чтобы увидеть, как работает функция 
прогнозирования.
 
```python
print("Making predictions for the following 5 houses:")
print(X.head())
print("The predictions are")
print(melbourne_model.predict(X.head()))
```

###Упражнения
###Шаг 1. Укажите цель прогноза
Выберите целевую переменную, соответствующую продажной цене. Сохраните это в новой переменной с именем y. Вам нужно 
будет распечатать список столбцов, чтобы найти имя нужного столбца.

```python
# распечатать список столбцов в наборе данных, чтобы найти имя цели прогноза
y = home_data.SalePrice
```
###Шаг 2: Создайте X
Теперь вы создадите DataFrame под названием X, содержащий функции прогнозирования.
Поскольку вам нужны только некоторые столбцы из исходных данных, вы сначала создадите список с именами нужных 
столбцов в X.

Вы будете использовать только следующие столбцы в списке (вы можете скопировать и вставить весь список, чтобы не 
набирать текст, хотя вам все равно нужно будет добавить кавычки): * LotArea * YearBuilt * 1stFlrSF * 2ndFlrSF * 
FullBath * BedroomAbvGr * TotRmsAbvGrd

После того, как вы создали этот список функций, используйте его для создания DataFrame, который вы будете 
использовать для соответствия модели.
```python
# Create the list of features below
feature_names =  ['LotArea', 'YearBuilt', '1stFlrSF', '2ndFlrSF', 'FullBath', 'BedroomAbvGr', 'TotRmsAbvGrd']

# Select data corresponding to features in feature_names
X = home_data[feature_names]
```

Просмотреть данные
Перед построением модели взгляните на X, чтобы убедиться, что она выглядит разумной.

```python
# Review data
# print description or statistics from X
print(X.describe())

# print the top few lines
print(X.head())
```

###Шаг 3: Укажите и установите модель¶
Создайте DecisionTreeRegressor и сохраните его iowa_model. Убедитесь, что вы выполнили соответствующий импорт из 
sklearn для запуска этой команды.

Затем подгоните модель, которую вы только что создали, используя данные в координатах X и y, которые вы сохранили выше.

```python
# из _ import _
from sklearn.tree import DecisionTreeRegressor
# укажите модель.
# Для воспроизводимости модели установите числовое значение для random_state при указании модели

iowa_model = DecisionTreeRegressor(random_state=1)

# Fit the model
iowa_model.fit(X, y)

# Check your answer

```

###Шаг 4. Делайте прогнозы
Делайте прогнозы с помощью команды прогнозирования модели, используя X в качестве данных. Сохраните результаты в 
переменной, называемой предсказаниями.

```python
predictions = iowa_model.predict(X.head())
print(predictions)
```
