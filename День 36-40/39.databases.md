## Знания, связанные с базами данных

### Теория парадигмы

Теория парадигм - это руководящая идеология для разработки двумерных таблиц в реляционных базах данных.

1. Первая нормальная форма: диапазон значений каждого столбца таблицы данных состоит из атомарных значений и не может 
быть разделен.
2. Вторая парадигма: все данные в таблице данных должны полностью зависеть от ключа (первичного ключа и 
   ключа-кандидата) таблицы данных.
3. Третья парадигма: все неключевые атрибуты связаны только с ключами-кандидатами, то есть неключевые атрибуты должны 
   быть независимыми и не связанными.


> Примечание: в реальной работе, из соображений эффективности, мы, вероятно, сделаем антипарадигмальный дизайн при 
> разработке таблицы, то есть намеренно снизим уровень режима и добавим избыточные данные для повышения 
> производительности.   
> 
### Целостность данных

1. Целостность сущности - каждая сущность уникальна

   - Первичный ключ（`primary key`） / уникальное ограничение（`unique`）
2. Ссылочная целостность (ссылочная целостность) - ссылки на несуществующие объекты не допускаются во взаимосвязи

   - Внешний ключ （`foreign key`）
3. Данные о целостности домена действительны
   - Тип и длина данных

   - Непустое ограничение（`not null`）

   - Ограничения значений по умолчанию（`default`）

   - Проверить ограничение（`check`）

     >  До MySQL 8.x проверка ограничений не работала.

### Согласованность данных

1. Транзакция: серия операций чтения / записи в базе данных. Либо все эти операции завершаются успешно, либо все 
   терпят неудачу.

2. ACID характеристики транзакций
   - Атомарность: транзакция выполняется как единое целое, а операции с содержащейся в ней базой данных либо выполняются, либо не выполняются.
   - Согласованность: транзакция должна гарантировать, что состояние базы данных изменится с одного согласованного состояния на другое согласованное состояние.
   - Изоляция: когда несколько транзакций выполняются одновременно, выполнение одной транзакции не должно влиять на выполнение других транзакций.
   - Постоянство: изменения в базе данных, сделанные зафиксированной транзакцией, должны постоянно храниться в базе данных. 

3. Операции с транзакциями в MySQL

   - Откройте бизнес-среду

     ```SQL
     start transaction
     ```

   - Подтвердить транзакцию

     ```SQL
     commit
     ```

   - Откат транзакции

     ```SQL
     rollback
     ```

4. Просмотр уровня изоляции транзакции

    ```SQL
    show variables like 'transaction_isolation';
    ```

    ```
    +-----------------------+-----------------+
    | Variable_name         | Value           |
    +-----------------------+-----------------+
    | transaction_isolation | REPEATABLE-READ |
    +-----------------------+-----------------+
    ```

    Можно видеть, что уровень изоляции транзакций MySQL по умолчанию равен REPEATABLE-READ.

5. Изменить уровень изоляции транзакции (текущий сеанс)

    ```SQL
    set session transaction isolation level read committed;
    ```

    Просмотрите уровень изоляции транзакции, и результат будет следующим.

    ```
    +-----------------------+----------------+
    | Variable_name         | Value          |
    +-----------------------+----------------+
    | transaction_isolation | READ-COMMITTED |
    +-----------------------+----------------+
    ```

Транзакции реляционной базы данных - большая тема, потому что, когда есть несколько одновременных транзакций, 
обращающихся к данным, могут быть три типа проблем чтения данных (грязное чтение, неповторяющееся чтение и фантомное 
чтение) и два типа проблем обновления данных (первый тип недостающих обновлений, второй тип недостающих обновлений). 
Если вы хотите понять эти пять типов вопросов, вы можете прочитать вопрос 80 статьи «Полный сборник вопросов для 
собеседований по Java ( часть 1 )», опубликованной на веб-сайте CSDN. Чтобы избежать этих проблем, в нижней части 
реляционной базы данных имеется соответствующий механизм блокировки, который можно разделить на блокировки на уровне 
таблицы и блокировки на уровне строк в соответствии с объектами блокировки, а также на разделяемые блокировки и 
эксклюзивные блокировки. блокируется в соответствии с взаимосвязью блокировки одновременных транзакций. Однако 
использовать блокировки напрямую очень проблематично. По этой причине база данных предоставляет пользователям 
механизм автоматической блокировки. Пока пользователь указывает соответствующий уровень изоляции транзакции, база 
данных будет анализировать операторы SQL, а затем добавлять соответствующие блокировки в ресурсы, к которым 
обращается транзакция. Кроме того, база данных будет поддерживать эти блокировки для повышения производительности 
системы с помощью различных средств, которые прозрачны для пользователей. Если вы хотите разобраться в деталях 
транзакций и блокировок MySQL, я рекомендую вам прочитать расширенное руководство «High Performance MySQL», которое 
также является классической книгой по базам данных.               

Стандарт ANSI / ISO SQL 92 определяет 4 уровня изоляции транзакций, как показано в следующей таблице. Следует 
отметить, что уровень изоляции транзакции и параллелизм доступа к данным противоположны: чем выше уровень изоляции 
транзакции, тем хуже параллелизм. Следовательно, необходимо определить, какой уровень изоляции транзакции 
использовать в соответствии с конкретным приложением, поскольку здесь нет принципа всемогущества.    

### Итого

Знания о SQL и MySQL, безусловно, намного больше, чем перечисленные выше, такие как оптимизация самого SQL, 
настройка производительности MySQL, инструменты, связанные с эксплуатацией и обслуживанием MySQL, резервное 
копирование и восстановление данных MySQL, мониторинг служб MySQL, развертывание архитектуры высокой доступности и т.
Д. Здесь невозможно обсудить эту серию вопросов по очереди, поэтому оставьте это объяснению, когда это необходимо. 
Читатели также могут исследовать самостоятельно.    