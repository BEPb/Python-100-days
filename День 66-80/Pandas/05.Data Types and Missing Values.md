Data Types and Missing Values
###Типы данных и отсутствующие значения
Вступление
В этом руководстве вы узнаете, как исследовать типы данных в DataFrame или Series. Вы  также узнаете, как находить и 
заменять записи.

Чтобы начать упражнение по этой теме, щелкните здесь.

###Dtypes
Тип данных для столбца в DataFrame или Series известен как dtype.

Вы можете использовать свойство dtype, чтобы получить тип определенного столбца. Например, мы можем получить dtype 
столбца цен в DataFrame обзоров:
```python
import pandas as pd
reviews = pd.read_csv("../input/wine-reviews/winemag-data-130k-v2.csv", index_col=0)
pd.set_option('max_rows', 5)
reviews.price.dtype
```
В качестве альтернативы свойство dtypes возвращает dtype каждого столбца в DataFrame:
```python
reviews.dtypes
```
Типы данных говорят нам кое-что о том, как pandas хранит данные внутри. float64 означает, что он использует 
64-битное число с плавающей запятой; int64 означает целое число аналогичного размера и т. д.

Следует иметь в виду одну особенность (и которая здесь очень четко проявляется) заключается в том, что столбцы, 
 полностью состоящие из строк, не имеют собственного типа; вместо этого им присваивается тип объекта.

Можно преобразовать столбец одного типа в другой везде, где такое преобразование имеет смысл, с помощью функции 
 astype (). Например, мы можем преобразовать столбец точек из существующего типа данных int64 в тип данных float64:
```python
reviews.points.astype('float64')
```
Индекс DataFrame или Series также имеет свой собственный dtype:
```python
reviews.index.dtype
```
Pandas также поддерживает более экзотические типы данных, такие как категориальные данные и данные временных рядов. 
Поскольку эти типы данных используются реже, мы опустим их до гораздо более позднего раздела этого руководства.

###Недостающие данные
Пропущенным значениям записей присваивается значение NaN, сокращение от «Not a Number». По техническим причинам эти 
значения NaN всегда имеют тип float64 dtype.

Pandas предоставляет некоторые методы, специфичные для отсутствующих данных. Чтобы выбрать записи NaN, вы можете 
использовать pd.isnull () (или его компаньон pd.notnull ()). Это предназначено для использования таким образом:
```python
reviews[pd.isnull(reviews.country)]
```
Замена отсутствующих значений - обычная операция. Pandas предоставляет действительно удобный метод для решения этой 
проблемы: fillna(). fillna() предоставляет несколько различных стратегий для смягчения таких данных. Например, мы 
можем просто заменить каждое NaN на «Неизвестно»:
```python
reviews.region_2.fillna("Unknown")
```
Или мы могли бы заполнить каждое пропущенное значение первым ненулевым значением, которое появляется через 
некоторое время после данной записи в базе данных. Это известно как стратегия обратной засыпки.

В качестве альтернативы у нас может быть ненулевое значение, которое мы хотели бы заменить. Например, предположим, 
что после публикации этого набора данных рецензент Керин О'Киф изменила свой дескриптор Twitter с @kerinokeefe на 
@kerino. Один из способов отразить это в наборе данных - использовать метод replace ():
```python
reviews.taster_twitter_handle.replace("@kerinokeefe", "@kerino")
```
Здесь стоит упомянуть метод replace(), потому что он удобен для замены отсутствующих данных, которым в наборе 
данных присваивается какое-то контрольное значение: такие вещи, как «Неизвестно», «Неизвестно», «Недействительно» и 
т. д.

###Вступление¶
Запустите следующую ячейку, чтобы загрузить данные и некоторые служебные функции.
```python
import pandas as pd

reviews = pd.read_csv("../input/wine-reviews/winemag-data-130k-v2.csv", index_col=0)

from learntools.core import binder; binder.bind(globals())
from learntools.pandas.data_types_and_missing_data import *
print("Setup complete.")
```
###Упражнения¶

1. Каков тип данных столбца точек в наборе данных?
```python
# Your code here
dtype = reviews.points.dtype
```
2. Создайте серию из записей в столбце точек, но преобразуйте записи в строки. Подсказка: в нативном Python строки 
   являются строками.
```python
point_strings = reviews.points.astype(str)
```
3. Иногда столбец цен пустой. Сколько обзоров в наборе данных не имеют цены?
```python
missing_price_reviews = reviews[reviews.price.isnull()]
n_missing_prices = len(missing_price_reviews)
# Cute alternative solution: if we sum a boolean series, True is treated as 1 and False as 0
n_missing_prices = reviews.price.isnull().sum()
# or equivalently:
n_missing_prices = pd.isnull(reviews.price).sum()
```
4. Какие регионы виноделия наиболее распространены? Создайте серию, подсчитывающую, сколько раз каждое значение 
    встречается в поле region_1. В этом поле часто отсутствуют данные, поэтому замените отсутствующие значения на 
 "Неизвестно". Сортировать по убыванию. Ваш результат должен выглядеть примерно так:
```python
reviews_per_region = reviews.region_1.fillna('Unknown').value_counts().sort_values(ascending=False)
```